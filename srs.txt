ðŸ“˜ Software Requirements Specification (SRS)
Windows Printer HTTP Service (WPHS)

Version 1.0

1. Introduction
1.1 Purpose

The Windows Printer HTTP Service (WPHS) provides a lightweight HTTP interface to expose local printers and allow external systems to print raw ESC/POS data. This document defines all functional and non-functional requirements for the system.

1.2 Scope

WPHS runs as a Windows Service and allows applications to:

Discover printers

Send raw ESC/POS commands

Submit Base64-encoded print jobs

It is designed for POS systems, receipt printers, and SaaS applications that require printing through local Windows machines.

1.3 Definitions
Term	Definition
ESC/POS	Command language used by thermal printers.
RAW printing	Sending bytes directly to printer with no formatting.
Windows Service	Background process managed by Windows Service Manager.
HTTP API	Interface for external clients to communicate using HTTP requests.
2. Overall Description
2.1 Product Perspective

WPHS is an independent Windows background service. It communicates with the Windows Print Spooler and exposes an HTTP API for lightweight printing.

2.2 Product Features Summary

âœ” Printer enumeration via HTTP

âœ” Print ESC/POS raw commands (HEX format)

âœ” Print ESC/POS Base64 data

âœ” Runs as a Windows Service

âœ” Lightweight, dependency-free HTTP server

2.3 User Classes
User	Description
POS Integrators	Use the API to print receipts.
Developers	Integrate local printers with cloud apps.
System Admins	Install and maintain the service.
2.4 Operating Environment

OS: Windows 10, Windows 11, Windows Server 2016+

.NET 6/7/8 runtime

Windows Print Spooler service enabled

Network availability for HTTP calls

2.5 Constraints

Must use Win32 Print Spooler API (winspool.drv)

Must not require external print rendering libraries

Runs without GUI

Limited to raw printer commands

2.6 Assumptions

Printers are pre-installed and configured

Windows Print Spooler is functional

External clients send valid ESC/POS commands

3. System Features (Functional Requirements)
3.1 Printer Enumeration API
Description

Lists all printers installed on the host Windows machine.

Endpoint
GET /printers

Functional Requirements

F-1: Must enumerate all printers available to the system.

F-2: Must return info in JSON format.

F-3: Must include printer name, status, and availability.

Sample Response
[
  { "name": "POS-80", "isOffline": false, "isBusy": false }
]

3.2 Raw ESC/POS Print API (HEX)
Endpoint
POST /print

Payload
{
  "printer": "POS-80",
  "data": "1B40 48 65 6C 6C 6F"
}

Functional Requirements

F-4: Convert HEX string to bytes.

F-5: Send bytes using RAW print mode.

F-6: Respond with success or error.

3.3 Base64 Print API
Endpoint
POST /print/base64

Payload
{
  "printer": "POS-80",
  "data": "GxBIZWxsbw=="
}

Functional Requirements

F-7: Decode Base64 into raw bytes.

F-8: Validate Base64 format.

F-9: Send bytes directly to the printer.

3.4 Error Handling Requirements

F-10: Must return HTTP 400 for invalid payloads.

F-11: Must return HTTP 404 for unknown endpoints.

F-12: Must return HTTP 500 for spooler failures.

F-13: Must log errors to Event Log or file.

4. Non-Functional Requirements
4.1 Performance

NF-1: Support at least 10 requests per second.

NF-2: Dispatch print job within 150 ms.

4.2 Security

NF-3: Default configuration must only accept local requests.

NF-4: Authentication may be added in future releases.

NF-5: Must not allow arbitrary file printing.

4.3 Reliability

NF-6: Service must automatically restart after reboot.

NF-7: Printer unavailability must not crash the service.

4.4 Maintainability

NF-8: Code must be modular to allow new print formats.

NF-9: Logging must include timestamp, endpoint, printer, and response.

4.5 Usability

NF-10: Must not require GUI.

NF-11: API messages must be simple and developer-friendly.

5. External Interface Requirements
5.1 HTTP Interface

Content-Type: JSON

Methods: GET, POST

Standard HTTP status codes

5.2 Operating System Interface

Uses Win32 Spooler APIs:

OpenPrinter

StartDocPrinter

WritePrinter

EndDocPrinter

6. System Architecture
+--------------------------------------------------+
|         Windows Printer HTTP Service             |
+--------------------------------------------------+
|  HttpListener (Port 8080)                        |
|     - GET /printers                              |
|     - POST /print                                |
|     - POST /print/base64                         |
+--------------------------------------------------+
|  Printer Controller                              |
|     - HEX decoder                                |
|     - Base64 decoder                             |
|     - ESC/POS raw sender                         |
+--------------------------------------------------+
|  Raw Printing Layer (Win32 API)                  |
|     - OpenPrinter                                |
|     - WritePrinter                               |
+--------------------------------------------------+

7. Future Enhancements

QR code printing

Barcode printing

Image/logo printing

HTTPS support

Remote authentication keys

UI dashboard

Printer status monitoring

8. Acceptance Criteria

The system is accepted when:

âœ” /printers returns list of installed printers

âœ” /print prints HEX ESC/POS commands

âœ” /print/base64 prints Base64 ESC/POS commands

âœ” Service installs and runs on Windows

âœ” Proper error codes are returned

âœ” All operations are logged